{
  "nodes": [
    {
      "id": "channels",
      "type": "channels",
      "position": {
        "x": -147.5089009902115,
        "y": 133.2701708588911
      },
      "data": {
        "theme": "channels"
      }
    },
    {
      "id": "hook",
      "type": "box",
      "position": {
        "x": 300,
        "y": 60
      },
      "data": {
        "title": "ticket-hook-service",
        "subtitle": "Normaliza eventos",
        "techs": [
          ".NET 10"
        ],
        "handles": {
          "in": [
            "top",
            "right",
            "bottom",
            "left"
          ],
          "out": [
            "top",
            "right",
            "bottom",
            "left"
          ]
        },
        "theme": "hook"
      }
    },
    {
      "id": "kafka",
      "type": "box",
      "position": {
        "x": 471.7356553282008,
        "y": 286.24964947516094
      },
      "data": {
        "title": "Kafka",
        "subtitle": "Topics consolidados",
        "cardWidth": 360,
        "handles": {
          "in": [
            "top",
            "right",
            "bottom",
            "left"
          ],
          "out": [
            "top",
            "right",
            "bottom",
            "left"
          ]
        },
        "theme": "kafka",
        "sections": [
          {
            "title": "message_received",
            "subtitle": "Hook → Incoming | p:60"
          },
          {
            "title": "events_denat",
            "subtitle": "Inc/Flow/TktMgr/Out → Proj | p:60"
          },
          {
            "title": "event_mail_received",
            "subtitle": "Mail → Inc.Mail | p:60"
          }
        ]
      }
    },
    {
      "id": "incoming",
      "type": "box",
      "position": {
        "x": 186.90482719182972,
        "y": 601.5884814665851
      },
      "data": {
        "title": "MS ticket-intake-service",
        "subtitle": "Consumer + Enrich (Outbox CONVERSATION)",
        "dbs": [
          "BD CONVERSATION (Postgres)",
          "BD CONFIG (Postgres)",
          "REDIS"
        ],
        "techs": [
          ".NET 10"
        ],
        "handles": {
          "in": [
            "top",
            "right",
            "bottom",
            "left"
          ],
          "out": [
            "top",
            "right",
            "bottom",
            "left"
          ]
        },
        "theme": "incoming"
      }
    },
    {
      "id": "flow",
      "type": "box",
      "position": {
        "x": 820.998882734108,
        "y": 637.6989999941236
      },
      "data": {
        "title": "MS ticket-flow-service",
        "subtitle": "Ingesta gRPC + BG Worker",
        "dbs": [
          "BD FLOW (Postgres)",
          "BD CONVERSATION (Postgres)"
        ],
        "techs": [
          ".NET 10"
        ],
        "handles": {
          "in": [
            "top",
            "right",
            "bottom",
            "left"
          ],
          "out": [
            "top",
            "right",
            "bottom",
            "left"
          ]
        },
        "theme": "flow",
        "sections": [
          {
            "title": "Ingesta gRPC",
            "subtitle": "Registra en BD FLOW y en Channel"
          },
          {
            "title": "BG Worker",
            "subtitle": "Lee Channel y ejecuta validando en BD"
          },
          {
            "title": "Outbox Relay",
            "subtitle": "BD FLOW → produce events_denat"
          }
        ]
      }
    },
    {
      "id": "outgoing",
      "type": "box",
      "position": {
        "x": -9.9302304801015,
        "y": 902.2228586692318
      },
      "data": {
        "title": "MS Outgoing",
        "subtitle": "Registra en BD CONVERSATION y envía al canal; Flow (bot) y BFF (asesor) por gRPC; proyecta events_denat",
        "dbs": [
          "BD CONVERSATION (Postgres)"
        ],
        "techs": [
          ".NET 10"
        ],
        "handles": {
          "in": [
            "top",
            "right",
            "bottom",
            "left"
          ],
          "out": [
            "top",
            "right",
            "bottom",
            "left"
          ]
        },
        "theme": "outgoing"
      }
    },
    {
      "id": "projector",
      "type": "box",
      "position": {
        "x": 1091.4742253993807,
        "y": 128.4167584602605
      },
      "data": {
        "title": "Projector",
        "subtitle": "Consume events_denat → Read Model",
        "techs": [
          ".NET 10"
        ],
        "handles": {
          "in": [
            "top",
            "right",
            "bottom",
            "left"
          ],
          "out": [
            "top",
            "right",
            "bottom",
            "left"
          ]
        },
        "theme": "projector"
      }
    },
    {
      "id": "readmodel",
      "type": "box",
      "position": {
        "x": 1575.2738913631617,
        "y": 194.4392012509283
      },
      "data": {
        "title": "BD Read Model",
        "subtitle": "Proyecciones de consulta",
        "dbs": [
          "BD Read Model (Postgres)"
        ],
        "handles": {
          "in": [
            "top",
            "right",
            "bottom",
            "left"
          ],
          "out": [
            "top",
            "right",
            "bottom",
            "left"
          ]
        },
        "theme": "read"
      }
    },
    {
      "id": "bff",
      "type": "box",
      "position": {
        "x": 1781.260743295059,
        "y": 711.0222436430478
      },
      "data": {
        "title": "BFF (API)",
        "subtitle": "Lee Read Model + CONFIG",
        "dbs": [
          "Read Model (Postgres)",
          "BD CONFIG (Postgres)"
        ],
        "techs": [
          "Node 22",
          "NestJS"
        ],
        "handles": {
          "in": [
            "top",
            "right",
            "bottom",
            "left"
          ],
          "out": [
            "top",
            "right",
            "bottom",
            "left"
          ]
        },
        "theme": "bff"
      }
    },
    {
      "id": "web",
      "type": "box",
      "position": {
        "x": 1789.465120255966,
        "y": 398.4671303814749
      },
      "data": {
        "title": "Cliente Web",
        "subtitle": "UI Laraigo",
        "techs": [
          "React"
        ],
        "handles": {
          "in": [
            "top",
            "right",
            "bottom",
            "left"
          ],
          "out": [
            "top",
            "right",
            "bottom",
            "left"
          ]
        },
        "theme": "web"
      }
    },
    {
      "id": "closeticket",
      "type": "box",
      "position": {
        "x": 1264.6671412149406,
        "y": 379.87972275406617
      },
      "data": {
        "title": "MS ticket-manager-service",
        "subtitle": "Manual gRPC (BFF) + BG cada n s; proyecta events_denat",
        "dbs": [
          "BD CONVERSATION (Postgres)",
          "REDIS"
        ],
        "techs": [
          ".NET 10"
        ],
        "handles": {
          "in": [
            "top",
            "right",
            "bottom",
            "left"
          ],
          "out": [
            "top",
            "right",
            "bottom",
            "left"
          ]
        },
        "theme": "close",
        "sections": [
          {
            "title": "AutoClose 24h",
            "subtitle": "BG: cierra OPEN sin respuesta ≥24h"
          },
          {
            "title": "Reassign HOLDING",
            "subtitle": "BG: busca asesor libre y reasigna"
          },
          {
            "title": "Manual Close/Derive",
            "subtitle": "gRPC desde BFF (y Flow opcional)"
          },
          {
            "title": "Outbox Relay",
            "subtitle": "BD CONVERSATION → produce events_denat"
          }
        ]
      }
    },
    {
      "id": "incomingmail",
      "type": "box",
      "position": {
        "x": 458.6316237326006,
        "y": 897.1563440654138
      },
      "data": {
        "title": "MS mail-intake-service",
        "subtitle": "Consumer event_mail_received + Enrich",
        "dbs": [
          "BD MAIL (Postgres)",
          "REDIS"
        ],
        "techs": [
          ".NET 10"
        ],
        "handles": {
          "in": [
            "top",
            "right",
            "bottom",
            "left"
          ],
          "out": [
            "top",
            "right",
            "bottom",
            "left"
          ]
        },
        "theme": "incoming"
      }
    },
    {
      "id": "ticketmailmanager",
      "type": "box",
      "position": {
        "x": 1276.6646022138586,
        "y": 1108.731340653878
      },
      "data": {
        "title": "MS mail-manager-service",
        "subtitle": "Cierre y asignación de tickets de mail",
        "dbs": [
          "BD MAIL (Postgres)"
        ],
        "techs": [
          ".NET 10"
        ],
        "handles": {
          "in": [
            "top",
            "right",
            "bottom",
            "left"
          ],
          "out": [
            "top",
            "right",
            "bottom",
            "left"
          ]
        },
        "theme": "close",
        "sections": [
          {
            "title": "Cierre automático",
            "subtitle": "BG: cierre de tickets por tiempo"
          },
          {
            "title": "Asignación",
            "subtitle": "BG: asignación de tickets de mail"
          }
        ]
      }
    }
  ],
  "edges": [
    {
      "id": "e1",
      "source": "channels",
      "sourceHandle": "out-right",
      "target": "hook",
      "targetHandle": "in-left",
      "label": "HTTP (webhooks)",
      "labelStyle": {
        "fill": "#06b6d4",
        "fontWeight": 600
      },
      "type": "smoothstep",
      "animated": true,
      "markerEnd": {
        "type": "arrowclosed",
        "color": "#06b6d4"
      },
      "style": {
        "strokeWidth": 2.2,
        "stroke": "#06b6d4"
      },
      "updatable": true
    },
    {
      "id": "e3",
      "source": "kafka",
      "sourceHandle": "out-bottom",
      "target": "incoming",
      "targetHandle": "in-right",
      "label": "consumer (groupId)",
      "labelStyle": {
        "fill": "#ef4444",
        "fontWeight": 600
      },
      "type": "smoothstep",
      "animated": true,
      "markerEnd": {
        "type": "arrowclosed",
        "color": "#ef4444"
      },
      "style": {
        "strokeWidth": 2.2,
        "stroke": "#ef4444"
      },
      "updatable": true
    },
    {
      "id": "e14",
      "source": "bff",
      "sourceHandle": "out-bottom",
      "target": "closeticket",
      "targetHandle": "in-right",
      "label": "gRPC manual",
      "labelStyle": {
        "fill": "#8b5cf6",
        "fontWeight": 600
      },
      "type": "smoothstep",
      "animated": true,
      "markerEnd": {
        "type": "arrowclosed",
        "color": "#8b5cf6"
      },
      "style": {
        "strokeWidth": 2.2,
        "stroke": "#8b5cf6"
      },
      "updatable": true
    },
    {
      "id": "reactflow__edge-outgoingout-left-channelsin-bottom",
      "source": "outgoing",
      "sourceHandle": "out-left",
      "target": "channels",
      "targetHandle": "in-bottom",
      "label": "APIs por conector",
      "labelStyle": {
        "fill": "#06b6d4",
        "fontWeight": 600
      },
      "type": "smoothstep",
      "animated": true,
      "markerEnd": {
        "type": "arrowclosed",
        "color": "#06b6d4"
      },
      "style": {
        "strokeWidth": 2.2,
        "stroke": "#06b6d4"
      },
      "updatable": true
    },
    {
      "id": "reactflow__edge-outgoingout-top-kafkain-left",
      "source": "outgoing",
      "sourceHandle": "out-top",
      "target": "kafka",
      "targetHandle": "in-left",
      "label": "producer (denat)",
      "labelStyle": {
        "fill": "#f59e0b",
        "fontWeight": 600
      },
      "type": "smoothstep",
      "animated": true,
      "markerEnd": {
        "type": "arrowclosed",
        "color": "#f59e0b"
      },
      "style": {
        "strokeWidth": 2.2,
        "stroke": "#f59e0b"
      },
      "updatable": true
    },
    {
      "id": "reactflow__edge-flowout-bottom-closeticketin-bottom",
      "source": "flow",
      "sourceHandle": "out-bottom",
      "target": "closeticket",
      "targetHandle": "in-bottom",
      "label": "gRPC (opcional)",
      "labelStyle": {
        "fill": "#8b5cf6",
        "fontWeight": 600
      },
      "type": "smoothstep",
      "animated": true,
      "markerEnd": {
        "type": "arrowclosed",
        "color": "#8b5cf6"
      },
      "style": {
        "strokeWidth": 2.2,
        "stroke": "#8b5cf6"
      },
      "updatable": true
    },
    {
      "id": "reactflow__edge-hookout-bottom-kafka",
      "source": "hook",
      "sourceHandle": "out-bottom",
      "target": "kafka",
      "targetHandle": null,
      "label": "producer",
      "labelStyle": {
        "fill": "#f59e0b",
        "fontWeight": 600
      },
      "type": "smoothstep",
      "animated": true,
      "markerEnd": {
        "type": "arrowclosed",
        "color": "#f59e0b"
      },
      "style": {
        "strokeWidth": 2.2,
        "stroke": "#f59e0b"
      },
      "updatable": true
    },
    {
      "id": "reactflow__edge-closeticketout-left-flowin-right",
      "source": "closeticket",
      "sourceHandle": "out-left",
      "target": "flow",
      "targetHandle": "in-right",
      "label": "gRPC (opcional)",
      "labelStyle": {
        "fill": "#8b5cf6",
        "fontWeight": 600
      },
      "type": "smoothstep",
      "animated": true,
      "markerEnd": {
        "type": "arrowclosed",
        "color": "#8b5cf6"
      },
      "style": {
        "strokeWidth": 2.2,
        "stroke": "#8b5cf6"
      },
      "updatable": true
    },
    {
      "id": "reactflow__edge-bffout-bottom-outgoingin-bottom",
      "source": "bff",
      "sourceHandle": "out-bottom",
      "target": "outgoing",
      "targetHandle": "in-bottom",
      "label": "gRPC",
      "labelStyle": {
        "fill": "#8b5cf6",
        "fontWeight": 600
      },
      "type": "smoothstep",
      "animated": true,
      "markerEnd": {
        "type": "arrowclosed",
        "color": "#8b5cf6"
      },
      "style": {
        "strokeWidth": 2.2,
        "stroke": "#8b5cf6"
      },
      "updatable": true
    },
    {
      "id": "reactflow__edge-closeticketout-left-kafkain-top",
      "source": "closeticket",
      "sourceHandle": "out-left",
      "target": "kafka",
      "targetHandle": "in-top",
      "label": "producer (denat)",
      "labelStyle": {
        "fill": "#f59e0b",
        "fontWeight": 600
      },
      "type": "smoothstep",
      "animated": true,
      "markerEnd": {
        "type": "arrowclosed",
        "color": "#f59e0b"
      },
      "style": {
        "strokeWidth": 2.2,
        "stroke": "#f59e0b"
      },
      "updatable": true
    },
    {
      "id": "reactflow__edge-incomingout-top-kafkain-left",
      "source": "incoming",
      "sourceHandle": "out-top",
      "target": "kafka",
      "targetHandle": "in-left",
      "label": "producer (denat)",
      "labelStyle": {
        "fill": "#f59e0b",
        "fontWeight": 600
      },
      "type": "smoothstep",
      "animated": true,
      "markerEnd": {
        "type": "arrowclosed",
        "color": "#f59e0b"
      },
      "style": {
        "strokeWidth": 2.2,
        "stroke": "#f59e0b"
      },
      "updatable": true
    },
    {
      "id": "reactflow__edge-flowout-bottom-outgoingin-right",
      "source": "flow",
      "sourceHandle": "out-bottom",
      "target": "outgoing",
      "targetHandle": "in-right",
      "label": "gRPC",
      "labelStyle": {
        "fill": "#8b5cf6",
        "fontWeight": 600
      },
      "type": "smoothstep",
      "animated": true,
      "markerEnd": {
        "type": "arrowclosed",
        "color": "#8b5cf6"
      },
      "style": {
        "strokeWidth": 2.2,
        "stroke": "#8b5cf6"
      },
      "updatable": true
    },
    {
      "id": "reactflow__edge-incomingout-bottom-flowin-left",
      "source": "incoming",
      "sourceHandle": "out-bottom",
      "target": "flow",
      "targetHandle": "in-left",
      "label": "gRPC",
      "labelStyle": {
        "fill": "#8b5cf6",
        "fontWeight": 600
      },
      "type": "smoothstep",
      "animated": true,
      "markerEnd": {
        "type": "arrowclosed",
        "color": "#8b5cf6"
      },
      "style": {
        "strokeWidth": 2.2,
        "stroke": "#8b5cf6"
      },
      "updatable": true
    },
    {
      "id": "reactflow__edge-flowout-top-kafkain-right",
      "source": "flow",
      "sourceHandle": "out-top",
      "target": "kafka",
      "targetHandle": "in-right",
      "label": "producer (denat)",
      "labelStyle": {
        "fill": "#f59e0b",
        "fontWeight": 600
      },
      "type": "smoothstep",
      "animated": true,
      "markerEnd": {
        "type": "arrowclosed",
        "color": "#f59e0b"
      },
      "style": {
        "strokeWidth": 2.2,
        "stroke": "#f59e0b"
      },
      "updatable": true
    },
    {
      "id": "reactflow__edge-webout-bottom-bffin-top",
      "source": "web",
      "sourceHandle": "out-bottom",
      "target": "bff",
      "targetHandle": "in-top",
      "label": "REST / WS",
      "labelStyle": {
        "fill": "#06b6d4",
        "fontWeight": 600
      },
      "type": "smoothstep",
      "animated": true,
      "markerEnd": {
        "type": "arrowclosed",
        "color": "#06b6d4"
      },
      "style": {
        "strokeWidth": 2.2,
        "stroke": "#06b6d4"
      },
      "updatable": true
    },
    {
      "id": "reactflow__edge-kafkaout-bottom-projectorin-left",
      "source": "kafka",
      "sourceHandle": "out-bottom",
      "target": "projector",
      "targetHandle": "in-left",
      "label": "consumer (projector)",
      "labelStyle": {
        "fill": "#ef4444",
        "fontWeight": 600
      },
      "type": "smoothstep",
      "animated": true,
      "markerEnd": {
        "type": "arrowclosed",
        "color": "#ef4444"
      },
      "style": {
        "strokeWidth": 2.2,
        "stroke": "#ef4444"
      },
      "updatable": true
    },
    {
      "id": "reactflow__edge-projectorout-right-readmodelin-top",
      "source": "projector",
      "sourceHandle": "out-right",
      "target": "readmodel",
      "targetHandle": "in-top",
      "label": "write (read model)",
      "labelStyle": {
        "fill": "#10b981",
        "fontWeight": 600
      },
      "type": "smoothstep",
      "animated": true,
      "markerEnd": {
        "type": "arrowclosed",
        "color": "#10b981"
      },
      "style": {
        "strokeWidth": 2.2,
        "stroke": "#10b981"
      },
      "updatable": true
    },
    {
      "id": "reactflow__edge-kafkaout-bottom-incomingmailin-top",
      "source": "kafka",
      "sourceHandle": "out-bottom",
      "target": "incomingmail",
      "targetHandle": "in-top",
      "label": "consumer (mail)",
      "labelStyle": {
        "fill": "#ef4444",
        "fontWeight": 600
      },
      "type": "smoothstep",
      "animated": true,
      "markerEnd": {
        "type": "arrowclosed",
        "color": "#ef4444"
      },
      "style": {
        "strokeWidth": 2.2,
        "stroke": "#ef4444"
      },
      "updatable": true
    },
    {
      "id": "reactflow__edge-bffout-left-readmodelin-bottom",
      "source": "bff",
      "sourceHandle": "out-left",
      "target": "readmodel",
      "targetHandle": "in-bottom",
      "label": "SQL (read)",
      "labelStyle": {
        "fill": "#14b8a6",
        "fontWeight": 600
      },
      "type": "smoothstep",
      "animated": true,
      "markerEnd": {
        "type": "arrowclosed",
        "color": "#14b8a6"
      },
      "style": {
        "strokeWidth": 2.2,
        "stroke": "#14b8a6"
      },
      "updatable": true
    },
    {
      "id": "reactflow__edge-incomingmailout-left-outgoingin-right",
      "source": "incomingmail",
      "sourceHandle": "out-left",
      "target": "outgoing",
      "targetHandle": "in-right",
      "label": "gRPC",
      "labelStyle": {
        "fill": "#8b5cf6",
        "fontWeight": 600
      },
      "type": "smoothstep",
      "animated": true,
      "markerEnd": {
        "type": "arrowclosed",
        "color": "#8b5cf6"
      },
      "style": {
        "strokeWidth": 2.2,
        "stroke": "#8b5cf6"
      },
      "updatable": true
    },
    {
      "id": "reactflow__edge-ticketmailmanagerout-left-outgoingin-bottom",
      "source": "ticketmailmanager",
      "sourceHandle": "out-left",
      "target": "outgoing",
      "targetHandle": "in-bottom",
      "label": "gRPC",
      "labelStyle": {
        "fill": "#8b5cf6",
        "fontWeight": 600
      },
      "type": "smoothstep",
      "animated": true,
      "markerEnd": {
        "type": "arrowclosed",
        "color": "#8b5cf6"
      },
      "style": {
        "strokeWidth": 2.2,
        "stroke": "#8b5cf6"
      },
      "updatable": true
    },
    {
      "id": "reactflow__edge-bffout-bottom-ticketmailmanagerin-right",
      "source": "bff",
      "sourceHandle": "out-bottom",
      "target": "ticketmailmanager",
      "targetHandle": "in-right",
      "label": "gRPC",
      "labelStyle": {
        "fill": "#8b5cf6",
        "fontWeight": 600
      },
      "type": "smoothstep",
      "animated": true,
      "markerEnd": {
        "type": "arrowclosed",
        "color": "#8b5cf6"
      },
      "style": {
        "strokeWidth": 2.2,
        "stroke": "#8b5cf6"
      },
      "updatable": true
    }
  ]
}